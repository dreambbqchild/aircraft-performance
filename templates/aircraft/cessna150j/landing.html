{%- import "macros/percent_between.html" as percent_between -%}
{%- import "macros/cessna150j/temperature_correction.html" as temperature_correction -%}
{%- import "macros/cessna150j/grass_correction.html" as grass_correction -%}
<!DOCTYPE html>
<html>
    <head>
        <title>Landing</title>
        <link rel="stylesheet" href="/styles.css">
        <script type="text/javascript" src="/scripts/child-main.js"></script>
    </head>
    <body>
        <h2>Landing</h2>
        <p>
            The airport elevation of {{cessna.elevation_ft}}' is 
            {% call percent_between::render(cessna.elevation_ft, cessna.atmosphere_bounds.lower.altitude, cessna.atmosphere_bounds.upper.altitude, cessna.altitude_tween_percentage, "'") %}
            of the way between {{cessna.atmosphere_bounds.lower.altitude}}' and {{cessna.atmosphere_bounds.upper.altitude}}'.
        </p>
        <p>
            The relevant distances are then:
            <table>
                <thead>
                    <tr>
                        <th colspan="2">{{cessna.atmosphere_bounds.lower.altitude}}' at {{cessna.atmosphere_bounds.lower.temperature}}°F</th>
                        <th colspan="2">{{cessna.elevation_ft}}' at {{cessna.standard_temperature_f}}°F</th>
                        <th colspan="2">{{cessna.atmosphere_bounds.upper.altitude}}' at {{cessna.atmosphere_bounds.upper.temperature}}°F</th>
                    </tr>
                    <tr>
                        <th>Ground Run</th>
                        <th>Total to Clear 50' Obs</th>
                        <th>Ground Run</th>
                        <th>Total to Clear 50' Obs</th>
                        <th>Ground Run</th>
                        <th>Total to Clear 50' Obs</th>             
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>{{calcs.landing_distances.lower_bound.ground_run()}}'</td>
                        <td>{{calcs.landing_distances.lower_bound.clear_50_ft_obstacle()}}'</td>
                        <td>{{calcs.landing_distances.middle_value.expect("middle_value to be set").ground_run() }}'</td>
                        <td>{{calcs.landing_distances.middle_value.expect("middle_value to be set").clear_50_ft_obstacle() }}'</td>
                        <td>{{calcs.landing_distances.upper_bound.ground_run()}}'</td>
                        <td>{{calcs.landing_distances.upper_bound.clear_50_ft_obstacle()}}'</td>
                    </tr>
                </tbody>
            </table>
        </p>
        <h3>Decrease distances shown by 10% for each 4 knots of headwind.</h3>
        <ul>
            <li>
                <math>
                    <mn>10%</mn>
                    <mo>&times</mo>
                    <mrow>
                        <mo>(</mo>
                        <mfrac>
                            <mn>{{cessna.headwind_kts}}</mn>
                            <mn>4</mn>
                        </mfrac>
                        <mo>)</mo>
                        <mo>≈</mo>
                        <mn>{{"{:.0}"|format(calcs.headwind_correction_percentage * 100.0)}}%</mn>
                    </mrow>
                </math>
            </li>
            <li>
                Ground Run:
                <math>
                    <mn>{{calcs.landing_distances.middle_value.expect("middle_value to be set").ground_run()}}</mn>
                    <mn>&times;</mn>
                    <mo>(</mo>
                    <mn>1</mn>
                    <mo>&minus;</mo>
                    <mn>{{"{:.2}"|format(calcs.headwind_correction_percentage)}}</mn>
                    <mo>)</mo>
                    <mo>&equals;</mo>
                    <mn>{{calcs.distance_with_headwind.ground_run()}}'</mn>
                </math>
            </li>
            <li>
                Clear 50' Obs:
                <math>
                    <mn>{{calcs.landing_distances.middle_value.expect("middle_value to be set").clear_50_ft_obstacle()}}</mn>
                    <mn>&times;</mn>
                    <mo>(</mo>
                    <mn>1</mn>
                    <mo>&minus;</mo>
                    <mn>{{"{:.2}"|format(calcs.headwind_correction_percentage)}}</mn>
                    <mo>)</mo>
                    <mo>&equals;</mo>
                    <mn>{{calcs.distance_with_headwind.clear_50_ft_obstacle()}}'</mn>
                </math>
            </li>
        </ul>

        <h3>Increase distances 10% for each 60°F in temperature above standard for the particular altitude.</h3>
        {% call temperature_correction::render(
            cessna.temperature_f, 
            cessna.standard_temperature_f, 
            cessna.temperature_f_diff_from_standard, 
            60, 
            calcs.correction.standard_temperature_correction_percentage, 
            calcs.distance_with_headwind.ground_run(), 
            calcs.correction.distance_corrected_for_temperature.ground_run(), 
            calcs.distance_with_headwind.clear_50_ft_obstacle(), 
            calcs.correction.distance_corrected_for_temperature.clear_50_ft_obstacle()) 
        %}

        <h3>For operation on a dry, grass runway increase distances (both "Ground Run" and "Total to Clear 50' Obstacle" by 20% of the "Total to Clear 50' Obstacle") figure.</h3>
        {% call grass_correction::render(
            calcs.correction.distance_corrected_for_temperature.clear_50_ft_obstacle(),
            0.2,
            calcs.correction.grass_offset,
            calcs.correction.distance_corrected_for_temperature.ground_run(),
            calcs.correction.distance_corrected_for_grass.ground_run(),
            calcs.correction.distance_corrected_for_grass.clear_50_ft_obstacle())
        %}
    </body>
</html>